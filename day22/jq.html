<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>珠峰培训</title>
    <style>
        body,
        ul,
        li {
            margin: 0;
            padding: 0;
            list-style: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="price.css" />
</head>

<body>b
    <div class="wrap">
        <div class="box">
            <ul class="list">
                <li>
                    <i></i>
                    <em>0</em>
                    <i></i>
                    <span>
                        单价：<strong>12.5元 </strong> 小计：<strong>0元</strong>
                    </span>
                </li>
                <li>
                    <i></i>
                    <em>0</em>
                    <i></i>
                    <span>
                        单价：<strong>10.5元 </strong> 小计：<strong>0元</strong>
                    </span>
                </li>
                <li>
                    <i></i>
                    <em>0</em>
                    <i></i>
                    <span>
                        单价：<strong>8.5元 </strong> 小计：<strong>0元</strong>
                    </span>
                </li>
                <li>
                    <i></i>
                    <em>0</em>
                    <i></i>
                    <span>
                        单价：<strong>8元 </strong> 小计：<strong>0元</strong>
                    </span>
                </li>
                <li>
                    <i></i>
                    <em>0</em>
                    <i></i>
                    <span>
                        单价：<strong>14.5元 </strong> 小计：<strong>0元</strong>
                    </span>
                </li>
            </ul>
            <div class="info">
                <span>商品共合计：<em>0</em>件</span>
                <span>共花费了：<em>0</em>元</span>
                <br />
                <br />
                <span>其中最贵的商品单价是：<em>0</em>元</span>
            </div>
        </div>
    </div>
    <script src="./jquery-1.11.3.js"></script>
    <script>

        let $list = $('li');
        
        

        for (let i = 0; i < $list.length; i++) {
            addClick($list[i]);
        }

        function addClick(li) {
            let $firstEm = li.$('em')[0];
            let $down =li.$('i')[0];
            let $up = li.$('i')[1];
            let $strong = li.$('strong');

            
            let num = Number($firstEm.innerText);
            console.log(num);
            let price = parseFloat($strong[0].innerText);// 获取单价
            $down.onclick = function () {
                if (num <= 0) {
                    num = 0;
                } else {

                    num--;
                    $firstEm.innerText = num;
                }


                $strong[1].innerText = num * price + '元';
                change();

            }

            $up.onclick = function () {
                num++;
                $firstEm.innerText = num,

                    $strong[1].innerText = num * price + '元';
                    change();

            }
        }

        /*
            1、商品总数量：
                1、创建一个变量，用来累加每一个商品的数量
                2、把每一个商品的数量累加起来
                3、把商品数量额显示到页面
            2、总合计：
                1、创建一个变量，用来累加每一个商品的小计
                2、把每一个商品的小计累加起来
                3、把商品总计显示到页面
            3、最贵的商品单价：
                1、创建一个数组，用来存放购买商品的单价
                2、把你购买的商品的单价放到数组里，并且给他排序
                3、把数组的最大值显示到页面上
             */
             function change(){
                let total = 0;
             let allPrice = 0;
             let ary  =[0];

             for(let i=0;i<$list.length;i++){
                 let $em = $list[i].$('em')[0];
                 console.log($em);
                
                 let $strong = $list[i].$('strong');
                 let price = parseFloat($strong[1].innerText);

                total += Number($em.innerText);
                console.log(total);
                allPrice += price;

                if(Number($em.innerText) >= 1){
                    ary.push(parseFloat($strong[0].innerText));
                }
             }
             ary.sort((a,b)=> b - a);
             let $lastEms = $('.info em');
             $lastEms[0].innerText = total;
             $lastEms[1].innerText = allPrice;
             $lastEms[2].innerText = ary[0];
             }


    </script>
</body>

</html>